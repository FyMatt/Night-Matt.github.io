import{w as x,s as P,E as f,d as y,r as V,a as g,c as F,j as b,e as r,f as u,g as i,o as E,l as w,p as N,m as T,_ as $}from"./index-D2xq2Qxj.js";const C=async n=>{try{const a=x.api_baseUrl+"api/login",_=await P(a,n),{success:c}=JSON.parse(JSON.stringify(_));return c}catch{return f.error("出现错误,无法操作!"),!1}},U=n=>(N("data-v-ff28244f"),n=n(),T(),n),h={class:"login"},B={class:"box"},L=U(()=>b("h2",null,"用户登录",-1)),R=y({__name:"Login",setup(n){const a=V(),_=(s,e,t)=>{if(e==="")t(new Error("请输入账号！"));else if(!/^[a-zA-Z0-9_+]{3,18}$/.test(e))t(new Error("账号只能包含字母、数字和下划线，长度为3-18个字符！"));else{if(o.userId!==""&&!a.value)return;t()}},c=(s,e,t)=>{e===""?t(new Error("请输入密码！")):/^[a-zA-Z0-9_+]{8,20}$/.test(e)?t():t(new Error("密码只能包含字母、数字和下划线，长度为8-20个字符！"))},o=g({userId:"",userPwd:""}),I=g({userId:[{validator:_,trigger:"blur"}],userPwd:[{validator:c,trigger:"blur"}]}),v=s=>{s&&s.validate(async e=>{if(e){let t;const l=new Date().getTime(),d=Number(localStorage.getItem("matt_blob_timestamp"));if(l>d?(localStorage.removeItem("matt_blob_userId"),localStorage.removeItem("matt_blob_userPwd"),localStorage.removeItem("matt_blob_timestamp")):t=!0,t=await C({userForm:o,matt_blob_token:localStorage.getItem("matt_blob_token")}),t){const p=(new Date().getTime()+864e5).toString();localStorage.setItem("matt_blob_timestamp",p),localStorage.setItem("matt_blob_userId",o.userId),localStorage.setItem("matt_blob_userPwd",o.userPwd),f({message:"登录成功,3s后自动跳转主页!",type:"success"}),setTimeout(()=>{window.location.href="/"},3e3)}else f.error("验证失败,小机灵鬼,你不是我噢~")}else return!1})},S=s=>{s&&s.resetFields()};return document.title="Blob Login",(s,e)=>{const t=i("el-input"),l=i("el-form-item"),d=i("el-button"),p=i("el-form");return E(),F("div",h,[b("div",B,[L,r(p,{ref_key:"userInfoForm",ref:a,style:{"max-width":"400px"},model:o,"status-icon":"",rules:I,"label-width":"auto",class:"demo-ruleForm"},{default:u(()=>[r(l,{label:"账户",prop:"userId"},{default:u(()=>[r(t,{modelValue:o.userId,"onUpdate:modelValue":e[0]||(e[0]=m=>o.userId=m)},null,8,["modelValue"])]),_:1}),r(l,{label:"密码",prop:"userPwd"},{default:u(()=>[r(t,{modelValue:o.userPwd,"onUpdate:modelValue":e[1]||(e[1]=m=>o.userPwd=m),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),r(l,null,{default:u(()=>[r(d,{type:"primary",onClick:e[2]||(e[2]=m=>v(a.value))},{default:u(()=>[w("登录")]),_:1}),r(d,{onClick:e[3]||(e[3]=m=>S(a.value))},{default:u(()=>[w("清空")]),_:1})]),_:1})]),_:1},8,["model","rules"])])])}}}),z=$(R,[["__scopeId","data-v-ff28244f"]]);export{z as default};
