import{d as w,r as m,v as O,x,y as B,o as y,c as h,z as F,A as S,w as A,s as j,E as p,B as D,e as v,f as N,j as H,u as C,g as b,l as I,_ as M}from"./index-BD6kJNY7.js";import{i as U,Q as k,a as L}from"./index.esm-ChyYMOIm.js";var R=Object.defineProperty,T=Object.defineProperties,J=Object.getOwnPropertyDescriptors,E=Object.getOwnPropertySymbols,Q=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable,V=(t,e,o)=>e in t?R(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,q=(t,e)=>{for(var o in e||(e={}))Q.call(e,o)&&V(t,o,e[o]);if(E)for(var o of E(e))z.call(e,o)&&V(t,o,e[o]);return t},G=(t,e)=>T(t,J(e));function c(t){let e=`请使用 '@${t}' 事件，不要放在 props 中`;return e+=`
Please use '@${t}' event instead of props`,e}var $=(t,e)=>{for(const[o,r]of e)t[o]=r;return t};const K=w({props:{mode:{type:String,default:"default"},defaultContent:{type:Array,default:[]},defaultHtml:{type:String,default:""},defaultConfig:{type:Object,default:{}},modelValue:{type:String,default:""}},setup(t,e){const o=m(null),r=O(null),s=m(""),i=()=>{if(!o.value)return;const d=S(t.defaultContent);U({selector:o.value,mode:t.mode,content:d||[],html:t.defaultHtml||t.modelValue||"",config:G(q({},t.defaultConfig),{onCreated(n){if(r.value=n,e.emit("onCreated",n),t.defaultConfig.onCreated){const l=c("onCreated");throw new Error(l)}},onChange(n){const l=n.getHtml();if(s.value=l,e.emit("update:modelValue",l),e.emit("onChange",n),t.defaultConfig.onChange){const u=c("onChange");throw new Error(u)}},onDestroyed(n){if(e.emit("onDestroyed",n),t.defaultConfig.onDestroyed){const l=c("onDestroyed");throw new Error(l)}},onMaxLength(n){if(e.emit("onMaxLength",n),t.defaultConfig.onMaxLength){const l=c("onMaxLength");throw new Error(l)}},onFocus(n){if(e.emit("onFocus",n),t.defaultConfig.onFocus){const l=c("onFocus");throw new Error(l)}},onBlur(n){if(e.emit("onBlur",n),t.defaultConfig.onBlur){const l=c("onBlur");throw new Error(l)}},customAlert(n,l){if(e.emit("customAlert",n,l),t.defaultConfig.customAlert){const u=c("customAlert");throw new Error(u)}},customPaste:(n,l)=>{if(t.defaultConfig.customPaste){const a=c("customPaste");throw new Error(a)}let u;return e.emit("customPaste",n,l,a=>{u=a}),u}})})};function _(d){const n=r.value;n!=null&&n.setHtml(d)}return x(()=>{i()}),B(()=>t.modelValue,d=>{d!==s.value&&_(d)}),{box:o}}}),W={ref:"box",style:{height:"100%"}};function X(t,e,o,r,s,i){return y(),h("div",W,null,512)}var Y=$(K,[["render",X]]);const Z=w({props:{editor:{type:Object},mode:{type:String,default:"default"},defaultConfig:{type:Object,default:{}}},setup(t){const e=m(null),o=r=>{if(e.value){if(r==null)throw new Error("Not found instance of Editor when create <Toolbar/> component");k.getToolbar(r)||L({editor:r,selector:e.value||"<div></div>",mode:t.mode,config:t.defaultConfig})}};return F(()=>{const{editor:r}=t;r!=null&&o(r)}),{selector:e}}}),ee={ref:"selector"};function te(t,e,o,r,s,i){return y(),h("div",ee,null,512)}var oe=$(Z,[["render",te]]);const ne=async t=>{try{if(localStorage.getItem("matt_blob_userId")==null)return!1;{const o=A.api_baseUrl+"api/sendarticle",r=await j(o,t),{success:s}=JSON.parse(JSON.stringify(r));return s?p({message:"成功发布文章!",type:"success"}):p.error("发布失败!"),s}}catch{return p.error("出现错误,无法发布文章!"),!1}},re={class:"editor-bg"},le={style:{border:"1px solid #ccc"}},ae=w({__name:"ArticleEditor",setup(t){const e=m(""),o=m(""),r=m(""),s=O(),i=m("<p></p>"),_={},d={placeholder:"请输入内容..."};D(()=>{const u=s.value;u!=null&&u.destroy()});const n=u=>{s.value=u};document.title="Article Editor";function l(){e.value&&o.value&&i.value.length>20?(ne({title:e.value,type:o.value,content:i.value,tag:r.value,matt_blob_token:localStorage.getItem("matt_blob_token")}),e.value="",o.value="",i.value="",r.value="",p({message:"成功提交文章，请等待发布结果!",type:"success"})):p.error("标题、类别、内容不准为空!")}return(u,a)=>{const g=b("el-input"),P=b("el-button");return y(),h("div",re,[v(g,{modelValue:e.value,"onUpdate:modelValue":a[0]||(a[0]=f=>e.value=f),style:{width:"30vw",margin:"20px 1vw"},placeholder:"请输入标题"},null,8,["modelValue"]),v(g,{modelValue:o.value,"onUpdate:modelValue":a[1]||(a[1]=f=>o.value=f),style:{width:"10vw",margin:"20px 1vw"},placeholder:"请输入类别"},null,8,["modelValue"]),v(g,{modelValue:r.value,"onUpdate:modelValue":a[2]||(a[2]=f=>r.value=f),style:{width:"10vw",margin:"20px 1vw"},placeholder:"请输入标签"},null,8,["modelValue"]),v(P,{type:"success",onClick:a[3]||(a[3]=f=>l()),round:""},{default:N(()=>[I("发布")]),_:1}),H("div",le,[v(C(oe),{style:{"border-bottom":"2px solid #ccc"},editor:s.value,defaultConfig:_},null,8,["editor"]),v(C(Y),{style:{height:"80vh","overflow-y":"hidden"},modelValue:i.value,"onUpdate:modelValue":a[4]||(a[4]=f=>i.value=f),defaultConfig:d,onOnCreated:n},null,8,["modelValue"])])])}}}),ie=M(ae,[["__scopeId","data-v-aba590fd"]]);export{ie as default};
